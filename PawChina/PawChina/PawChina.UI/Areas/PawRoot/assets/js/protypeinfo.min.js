function rightMsg(n,t){var i=$.trim(n.value);i.length>t&&(i=i.substring(0,t),$(n).val(i));$(n).parent().parent().find(".lot-blue").text("剩余字符数："+(t-i.length))}function setSelected(n,t){n.find("option[value='"+t+"']").attr("selected",!0);t==1?($("#ptype").css("display","none"),$(".lot-tagSelect").selectpicker("val","")):$("#ptype").css("display","")}function reloadTypes(n){$.post("/PawRoot/ProType/GetProTypes",{id:n},function(n){n.Status?($("#pid").html(""),$.each(n.Data,function(n,t){var i='<optgroup label="',r;for(t.length>0&&t[0].TFloor==1?i+='一级分类">':t.length>1&&t[0].TFloor==2&&(i+='二级分类">'),r=0;r<t.length;r++)i+='<option value="'+t[r].TId+'">'+t[r].TName+"<\/option>";i+="<\/optgroup>";$("#pid").append(i)}),$(".lot-tagSelect").selectpicker("refresh")):showMsg(n.Msg)})}function ajaxToProType(n){var t=$("#name").val(),i=$("#groupType").val(),r=$("#floor").val(),u=$(".lot-tagSelect").selectpicker("val"),f=$("#sort").val(),e=$("#displayPic").attr("src"),o=$("#container").val(),s=(new Date).getTime(),c,h;n?(c=$("#tId").val(),h=$("#dataStatus").val(),$.post("/PawRoot/ProType/Edit",{TId:tId,TName:t,TContent:o,TPid:u,TSort:f,TFloor:r,TUpdateTime:s,TGroupType:i,TDisplayPic:e,TDataStatus:h},function(n){n.Status?(showMsg(n.Msg,500),setTimeout(function(){window.location.href="/PawRoot/ProType/Index"},1e3)):showMsg(n.Msg)})):$.post("/PawRoot/ProType/Add",{TName:t,TContent:o,TPid:u,TSort:f,TFloor:r,TUpdateTime:s,TGroupType:i,TDisplayPic:e},function(n){n.Status?(showMsg(n.Msg,1500),setTimeout(function(){window.location.href="/PawRoot/ProType/Index"},1e3)):showMsg(n.Msg)})}$(document).ready(function(){$("#name").keyup(function(){rightMsg(this,100)});$("#container").keyup(function(){rightMsg(this,300)});$("#autoA").click(function(){setSelected($("#groupType"),1);reloadTypes(1)});$("#autoB").click(function(){setSelected($("#groupType"),2);reloadTypes(2)});$("#groupType").change(function(){reloadTypes($(this).val())});$("#autoC").click(function(){setSelected($("#floor"),1)});$("#autoD").click(function(){setSelected($("#floor"),2)});$("#autoE").click(function(){setSelected($("#floor"),3)});$("#floor").change(function(){setSelected($("#floor"),$(this).val())})});